import{r as T,j as _}from"./app-DoPl5lFM.js";import{b as x,m as w,d as y,e as M,G,i as B,f as c,R as k,X as P,V as N,A as R,D as V,a as j,L as A,C as O,B as C,c as v}from"./LineSeries-CBonYMjJ.js";class m extends x{constructor(){super(...arguments),Object.defineProperty(this,"thumb",{enumerable:!0,configurable:!0,writable:!0,value:this._makeThumb()}),Object.defineProperty(this,"startGrip",{enumerable:!0,configurable:!0,writable:!0,value:this._makeButton()}),Object.defineProperty(this,"endGrip",{enumerable:!0,configurable:!0,writable:!0,value:this._makeButton()}),Object.defineProperty(this,"_thumbBusy",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_startDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_endDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_thumbDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_gripDown",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_addOrientationClass(){this._settings.themeTags=w(this._settings.themeTags,["scrollbar",this._settings.orientation]),this._settings.background||(this._settings.background=y.new(this._root,{themeTags:w(this._settings.themeTags,["main","background"])}))}_makeButton(){return this.children.push(M.new(this._root,{themeTags:["resize","button",this.get("orientation")],icon:G.new(this._root,{themeTags:["icon"]})}))}_makeThumb(){return this.children.push(y.new(this._root,{themeTags:["thumb",this.get("orientation")]}))}_handleAnimation(t){t&&this._disposers.push(t.events.on("stopped",()=>{this.setPrivateRaw("isBusy",!1),this._thumbBusy=!1}))}_afterNew(){this._addOrientationClass(),super._afterNew();const t=this.startGrip,i=this.endGrip,a=this.thumb,o=this.get("background");o&&this._disposers.push(o.events.on("click",e=>{this.setPrivateRaw("isBusy",!0);const r=this._display.toLocal(e.point),s=this.width(),n=this.height(),l=this.get("orientation");let u;l=="vertical"?u=(r.y-a.height()/2)/n:u=(r.x-a.width()/2)/s;let h,d;l=="vertical"?(h=u*n,d="y"):(h=u*s,d="x");const p=this.get("animationDuration",0);p>0?(this._thumbBusy=!0,this._handleAnimation(this.thumb.animate({key:d,to:h,duration:p,easing:this.get("animationEasing")}))):(this.thumb.set(d,h),this._root.events.once("frameended",()=>{this.setPrivateRaw("isBusy",!1)}))})),this._disposers.push(a.events.on("dblclick",e=>{if(!B(e.originalEvent,this))return;const r=this.get("animationDuration",0),s=this.get("animationEasing");this.animate({key:"start",to:0,duration:r,easing:s}),this.animate({key:"end",to:1,duration:r,easing:s})})),this._disposers.push(t.events.on("pointerdown",()=>{this.setPrivateRaw("isBusy",!0),this._startDown=!0,this._gripDown="start"})),this._disposers.push(i.events.on("pointerdown",()=>{this.setPrivateRaw("isBusy",!0),this._endDown=!0,this._gripDown="end"})),this._disposers.push(a.events.on("pointerdown",()=>{this.setPrivateRaw("isBusy",!0),this._thumbDown=!0,this._gripDown=void 0})),this._disposers.push(t.events.on("globalpointerup",()=>{this._startDown&&this.setPrivateRaw("isBusy",!1),this._startDown=!1})),this._disposers.push(i.events.on("globalpointerup",()=>{this._endDown&&this.setPrivateRaw("isBusy",!1),this._endDown=!1})),this._disposers.push(a.events.on("globalpointerup",()=>{this._thumbDown&&this.setPrivateRaw("isBusy",!1),this._thumbDown=!1})),this._disposers.push(t.on("x",()=>{this._updateThumb()})),this._disposers.push(i.on("x",()=>{this._updateThumb()})),this._disposers.push(t.on("y",()=>{this._updateThumb()})),this._disposers.push(i.on("y",()=>{this._updateThumb()})),this._disposers.push(a.events.on("positionchanged",()=>{this._updateGripsByThumb()})),this.get("orientation")=="vertical"?(t.set("x",0),i.set("x",0),this._disposers.push(a.adapters.add("y",e=>Math.max(Math.min(Number(e),this.height()-a.height()),0))),this._disposers.push(a.adapters.add("x",e=>this.width()/2)),this._disposers.push(t.adapters.add("x",e=>this.width()/2)),this._disposers.push(i.adapters.add("x",e=>this.width()/2)),this._disposers.push(t.adapters.add("y",e=>Math.max(Math.min(Number(e),this.height()),0))),this._disposers.push(i.adapters.add("y",e=>Math.max(Math.min(Number(e),this.height()),0)))):(t.set("y",0),i.set("y",0),this._disposers.push(a.adapters.add("x",e=>Math.max(Math.min(Number(e),this.width()-a.width()),0))),this._disposers.push(a.adapters.add("y",e=>this.height()/2)),this._disposers.push(t.adapters.add("y",e=>this.height()/2)),this._disposers.push(i.adapters.add("y",e=>this.height()/2)),this._disposers.push(t.adapters.add("x",e=>Math.max(Math.min(Number(e),this.width()),0))),this._disposers.push(i.adapters.add("x",e=>Math.max(Math.min(Number(e),this.width()),0))))}_updateChildren(){super._updateChildren(),(this.isDirty("end")||this.isDirty("start")||this._sizeDirty)&&this.updateGrips()}_changed(){if(super._changed(),this.isDirty("start")||this.isDirty("end")){const t="rangechanged";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,start:this.get("start",0),end:this.get("end",1),grip:this._gripDown})}}updateGrips(){const t=this.startGrip,i=this.endGrip,a=this.get("orientation"),o=this.height(),e=this.width();a=="vertical"?(t.set("y",o*this.get("start",0)),i.set("y",o*this.get("end",1))):(t.set("x",e*this.get("start",0)),i.set("x",e*this.get("end",1)));const r=this.getPrivate("positionTextFunction"),s=Math.round(this.get("start",0)*100),n=Math.round(this.get("end",0)*100);let l,u;r?(l=r.call(this,this.get("start",0)),u=r.call(this,this.get("end",0))):(l=s+"%",u=n+"%"),t.set("ariaLabel",this._t("From %1",void 0,l)),t.set("ariaValueNow",""+s),t.set("ariaValueText",s+"%"),t.set("ariaValueMin","0"),t.set("ariaValueMax","100"),i.set("ariaLabel",this._t("To %1",void 0,u)),i.set("ariaValueNow",""+n),i.set("ariaValueText",n+"%"),i.set("ariaValueMin","0"),i.set("ariaValueMax","100")}_updateThumb(){const t=this.thumb,i=this.startGrip,a=this.endGrip,o=this.height(),e=this.width();let r=i.x(),s=a.x(),n=i.y(),l=a.y(),u=0,h=1;this.get("orientation")=="vertical"?c(n)&&c(l)&&(!this._thumbBusy&&!t.isDragging()&&(t.set("height",l-n),t.set("y",n)),u=n/o,h=l/o):c(r)&&c(s)&&(!this._thumbBusy&&!t.isDragging()&&(t.set("width",s-r),t.set("x",r)),u=r/e,h=s/e),this.getPrivate("isBusy")&&(this.get("start")!=u||this.get("end")!=h)&&(this.set("start",u),this.set("end",h));const d=this.getPrivate("positionTextFunction"),p=Math.round(this.get("start",0)*100),D=Math.round(this.get("end",0)*100);let g,b;d?(g=d.call(this,this.get("start",0)),b=d.call(this,this.get("end",0))):(g=p+"%",b=D+"%"),t.set("ariaLabel",this._t("From %1 to %2",void 0,g,b)),t.set("ariaValueNow",""+p),t.set("ariaValueText",p+"%")}_updateGripsByThumb(){const t=this.thumb,i=this.startGrip,a=this.endGrip;if(this.get("orientation")=="vertical"){const o=t.height();i.set("y",t.y()),a.set("y",t.y()+o)}else{const o=t.width();i.set("x",t.x()),a.set("x",t.x()+o)}}}Object.defineProperty(m,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Scrollbar"});Object.defineProperty(m,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:x.classNames.concat([m.className])});function X({readings:f,stepStat:t,date:i="topic_time",value:a="value"}){const o="chart"+Math.floor(Math.random()*1e16);T.useEffect(()=>{r()},[]);const e=()=>f.map(s=>({date:new Date(s[i]).getTime(),value:parseFloat(s[a])})),r=()=>{let s=k.new(o),n=s.container.children.push(P.new(s,{panY:!0,wheelY:"zoomX",layout:s.verticalLayout}));n.set("scrollbarX",m.new(s,{orientation:"horizontal"}));let l=n.yAxes.push(N.new(s,{renderer:R.new(s,{})})),u=n.xAxes.push(V.new(s,{baseInterval:{timeUnit:"minute",count:1},renderer:j.new(s,{inverted:!1})})),h=n.series.push(A.new(s,{name:"Test",xAxis:u,yAxis:l,valueYField:"value",valueXField:"date",seriesTooltipTarget:"bullet",locationX:0}));h.strokes.template.setAll({strokeWidth:2}),h.bullets.push(function(){let d=O.new(s,{radius:4,templateField:"bulletSettings",fill:h.get("fill"),strokeWidth:3,stroke:s.interfaceColors.get("background"),tooltipText:`[bold]{valueY}[/]
{valueX.formatDate("YYYY/MM/dd hh:mm a")}`});return C.new(s,{sprite:d,locationX:0})}),h.set("fill",v(9254746)),h.set("stroke",v(9254746)),h.data.setAll(e())};return _.jsxs("div",{className:"bg-white p-4 rounded-md shadow-md mb-4",children:[_.jsxs("p",{className:"text-center font-bold mb-4",children:[t.name," - ",t.step.name]}),_.jsx("div",{id:o,className:"w-full h-full",style:{height:300}})]})}export{X as R};
