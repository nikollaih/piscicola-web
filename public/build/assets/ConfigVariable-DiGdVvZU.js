import{q as k,r as c,W as p,j as e,y as w}from"./app-DoPl5lFM.js";import{T as n}from"./TextInput-B2uDKCmh.js";import{I as i}from"./InputLabel-C-Tz_r5K.js";import{I as t}from"./InputError-ByfgtF5w.js";import{P as g}from"./PrimaryButton-s6j7ElbD.js";import"./moment-C5S46NFB.js";import{D as o}from"./Dropdown-C-i2qCtQ.js";import{D as C,a as E}from"./DropDownItem-BiquOykW.js";import"./transition-YMyy0hwJ.js";function B({formActionUrl:j,formActionDeleteUrl:b,automation:l,onSuccess:m,steps:d}){console.log(l);const{errors:r}=k().props,u=c.useRef(null),[f,v]=c.useState("Seleccionar"),s=p({min_value:"",max_value:"",action:"min",variable_key:"",automationType:"variable"}),x=p({valor:"off"});c.useEffect(()=>{if(l!=null&&l.id){s.setData({...s.data,min_value:l.min_value,max_value:l.max_value,variable_key:l.variable_key,action:l.action});const a=d.find(N=>N.key===l.variable_key);a&&v(a.name)}},[l]);const h=a=>{a.preventDefault(),s.post(j,{onSuccess:()=>{m()}})},y=()=>{w.post(b,{...x.data,automationType:"variable"},{onSuccess:()=>{m(),x.reset(),u.current.click()}})},_=a=>{v(a.name),s.setData({...s.data,variable_key:a.key})},D=()=>d.map(a=>e.jsx(E,{onClick:()=>{_(a)},children:a.name},a.key));return e.jsx("form",{onSubmit:h,children:e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-5",children:[e.jsx("h4",{className:"font-semibold",children:"Automatización por variable"}),e.jsx("p",{className:"mb-4",children:"Encienda el actuador cuando el valor de una variable salga del rango seleccionado y se apaga al llegar al valor indicado."}),e.jsxs("div",{className:"md:col-span-2 sm:col-span-4 mb-2",children:[e.jsx(i,{value:"Variable"}),e.jsxs(o,{children:[e.jsx(o.Trigger,{children:e.jsx(C,{className:"items-center cursor-pointer",children:f})}),e.jsx(o.Content,{align:"left",className:"px-2",width:100,children:D()})]}),r!=null&&r.variable_key?e.jsx(t,{message:r.variable_key}):""]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(i,{value:"Valor minimo"}),e.jsx(n,{type:"number",name:"min_value",className:"w-full",value:s.data.min_value,required:!0,onChange:a=>s.setData("min_value",a.target.value)}),e.jsx(t,{message:r.min_value})]}),e.jsxs("div",{children:[e.jsx(i,{value:"Valor maximo"}),e.jsx(n,{type:"number",name:"max_value",className:"w-full",value:s.data.max_value,required:!0,onChange:a=>s.setData("max_value",a.target.value)}),e.jsx(t,{message:r.max_value})]})]}),e.jsxs("div",{children:[e.jsx(i,{value:"Accion"}),e.jsx(n,{type:"radio",name:"action",className:"w-4",value:"min",required:!0,checked:s.data.action==="min",onChange:a=>s.setData("action",a.target.value)})," Encender cuando este por debajo del valor minimo y apagar al llegar al valor maximo ",e.jsx("br",{}),e.jsx(n,{type:"radio",name:"action",className:"w-4",value:"max",required:!0,checked:s.data.action==="max",onChange:a=>s.setData("action",a.target.value)})," Encender cuando este por encima del valor maximo y apagar al llegar al valor minimo",e.jsx(t,{message:r.action})]}),e.jsxs("div",{className:"flex gap-4 justify-end mt-4",children:[(l==null?void 0:l.id)&&e.jsx(g,{type:"button",className:"bg-red-500",onClick:y,children:"Eliminar configuración"}),e.jsx(g,{className:"bg-orange-600",children:"Guardar"}),e.jsx("button",{type:"reset",className:"hidden",ref:u,children:"reset"})]})]})})}export{B as default};
