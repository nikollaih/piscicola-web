import{r,q as R,W as P,j as e,a as E,d as F}from"./app-DoPl5lFM.js";import{A as ee}from"./AuthenticatedLayout-BAzWT1Pc.js";import{T as x}from"./TextInput-B2uDKCmh.js";import{I as c}from"./InputLabel-C-Tz_r5K.js";import{D as i}from"./Dropdown-C-i2qCtQ.js";import{D as f,a as h}from"./DropDownItem-BiquOykW.js";import{P as M}from"./PrimaryButton-s6j7ElbD.js";import{I as m}from"./InputError-ByfgtF5w.js";import{A as se}from"./AlertMessage-CubBamYp.js";import{h as j}from"./moment-C5S46NFB.js";import{C as p}from"./Constants-Cwa85801.js";import"./SR-BoSPAYsv.js";import"./transition-YMyy0hwJ.js";function he({auth:I,fish:g,steps:_,ponds:v,sowing:u}){var D,T;const k=u!=null&&u.id?route("sowing.view",{sowingId:u.id}):route("sowings"),N=r.useRef(null),a=R().props.errors,t=R().props,{data:d,setData:l,post:O,patch:B,reset:L,processing:U}=P({step_id:null,fish_id:null,pond_id:null,quantity:null,manual_created_at:j().format(p.DATEFORMAT),fecha_estimada:"",name:""}),[z,w]=r.useState("Seleccionar"),[G,S]=r.useState("Seleccionar"),[W,y]=r.useState("Seleccionar"),[H,b]=r.useState("");r.useEffect(()=>{var s;(s=t==null?void 0:t.sowing)!=null&&s.id&&J(t.sowing)},[]);const J=s=>{var n,A,q;l({fish_id:s.fish_id,step_id:s.step_id,pond_id:s.pond_id,quantity:s.quantity,name:s.name,manual_created_at:j(s.manual_created_at).format(p.DATEFORMAT),fecha_estimada:s.fecha_estimada?j(s.fecha_estimada).format(p.DATEFORMAT):""}),w(((n=g.find(o=>o.id===s.fish_id))==null?void 0:n.name)||"Seleccionar"),S(((A=_.find(o=>o.id===s.step_id))==null?void 0:A.name)||"Seleccionar"),y(((q=v.find(o=>o.id===s.pond_id))==null?void 0:q.name)||"Seleccionar")},K=s=>{var n;s.preventDefault(),(n=t==null?void 0:t.sowing)!=null&&n.id?B(t.formActionUrl,{onSuccess:()=>C()}):O(t.formActionUrl,{onSuccess:()=>C()})},C=()=>{var n;let s="modificada";(n=t==null?void 0:t.sowing)!=null&&n.id||(L(),s="agregada"),b("La cosecha fue "+s+" satisfactoriamente"),N.current.click()},Q=s=>{l({...d,fish_id:s.id}),w(s.name)},V=s=>{l({...d,step_id:s.id}),S(s.name)},X=s=>{l({...d,pond_id:s.id}),y(s.name)},Y=()=>g.map(s=>e.jsx(h,{onClick:()=>{Q(s)},children:s.name},s.id)),Z=()=>_.map(s=>e.jsx(h,{onClick:()=>{V(s)},children:s.name},s.id)),$=()=>v.map(s=>e.jsx(h,{onClick:()=>{X(s)},children:s.name},s.id));return e.jsxs(ee,{user:I.user,children:[e.jsx(E,{title:"Cosecha"}),e.jsx("div",{className:"py-4 sm:py-12",children:e.jsx("form",{onSubmit:K,children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-4 lg:px-4",children:[e.jsx(se,{title:H,onClose:()=>b("")}),e.jsxs("div",{className:"flex justify-between items-start flex-wrap gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-1",children:[e.jsx(F,{href:"/sowings",className:"hover:text-gray-700",children:"Cultivo"}),e.jsx("span",{className:"mx-2",children:">"}),e.jsxs("span",{className:"text-gray-700",children:[(D=t==null?void 0:t.sowing)!=null&&D.id?"Modificar":"Agregar"," Cultivo"]})]}),e.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:[(T=t==null?void 0:t.sowing)!=null&&T.id?"Modificar":"Nuevo"," Cultivo"]})]}),e.jsx(F,{className:"w-full sm:w-auto",href:k,children:e.jsx(M,{children:"Regresar"})})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-5",children:[e.jsxs("div",{className:"grid md:grid-cols-3 sm:grid-cols-1 gap-4 xs:grid-cols-1 mb-4",children:[e.jsxs("div",{className:"w-full md:col-span-1",children:[e.jsx(c,{value:"Nombre"}),e.jsx(x,{type:"text",className:"w-full",name:"name",value:d.name,required:!0,onChange:s=>l(s.target.name,s.target.value)}),(a==null?void 0:a.name)&&e.jsx(m,{message:a.name})]}),e.jsxs("div",{className:"w-full md:col-span-1",children:[e.jsx(c,{value:"Producto"}),e.jsxs(i,{children:[e.jsx(i.Trigger,{children:e.jsx(f,{className:"items-center cursor-pointer",children:z})}),e.jsx(i.Content,{align:"left",className:"px-2",width:100,children:Y()})]}),(a==null?void 0:a.fish_id)&&e.jsx(m,{message:a.fish_id})]}),e.jsxs("div",{className:"w-full md:col-span-1",children:[e.jsx(c,{value:"Etapa"}),e.jsxs(i,{children:[e.jsx(i.Trigger,{children:e.jsx(f,{className:"items-center cursor-pointer",children:G})}),e.jsx(i.Content,{align:"left",className:"px-2",width:100,children:Z()})]}),(a==null?void 0:a.step_id)&&e.jsx(m,{message:a.step_id})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 sm:grid-cols-1 gap-4 xs:grid-cols-1 mb-4",children:[e.jsxs("div",{className:"w-full md:col-span-1",children:[e.jsx(c,{value:"Estanque"}),e.jsxs(i,{children:[e.jsx(i.Trigger,{children:e.jsx(f,{className:"items-center cursor-pointer",children:W})}),e.jsx(i.Content,{align:"left",className:"px-2",width:100,children:$()})]}),(a==null?void 0:a.pond_id)&&e.jsx(m,{message:a.pond_id})]}),e.jsxs("div",{className:"w-full md:col-span-1",children:[e.jsx(c,{value:"Fecha de siembra"}),e.jsx(x,{type:"date",className:"w-full",name:"manual_created_at",value:d.manual_created_at,required:!0,onChange:s=>l(s.target.name,s.target.value)}),(a==null?void 0:a.manual_created_at)&&e.jsx(m,{message:a.manual_created_at})]}),e.jsxs("div",{className:"w-full md:col-span-1",children:[e.jsx(c,{value:"Cantidad de peces"}),e.jsx(x,{type:"number",className:"w-full",name:"quantity",value:d.quantity,required:!0,onChange:s=>l(s.target.name,s.target.value)}),(a==null?void 0:a.quantity)&&e.jsx(m,{message:a.quantity})]})]}),e.jsx("div",{className:"grid md:grid-cols-3 sm:grid-cols-1 gap-4 xs:grid-cols-1 mb-4",children:e.jsxs("div",{className:"w-full md:col-span-1",children:[e.jsx(c,{value:"Fecha estimada de finalizaciÃ³n"}),e.jsx(x,{type:"date",className:"w-full",name:"fecha_estimada",value:d.fecha_estimada,onChange:s=>l(s.target.name,s.target.value)}),(a==null?void 0:a.fecha_estimada)&&e.jsx(m,{message:a.fecha_estimada})]})})]}),e.jsxs("div",{className:"flex gap-4 justify-end mt-4",children:[e.jsx(M,{className:"bg-orange-600 w-full sm:w-auto text-white",disabled:U,children:"Guardar"}),e.jsx("button",{type:"reset",className:"hidden",ref:N,children:"reset"})]})]})})})]})}export{he as default};
