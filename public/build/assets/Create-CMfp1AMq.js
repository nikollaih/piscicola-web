import{r as u,q as w,W as V,j as e,a as W,d as S,y as $}from"./app-DoPl5lFM.js";import{A as H}from"./AuthenticatedLayout-BAzWT1Pc.js";import{T as o}from"./TextInput-B2uDKCmh.js";import{T as J}from"./TextArea-BytP4p67.js";import{I as m}from"./InputLabel-C-Tz_r5K.js";import{D as d}from"./Dropdown-C-i2qCtQ.js";import{D as b,a as D}from"./DropDownItem-BiquOykW.js";import{P as U}from"./PrimaryButton-s6j7ElbD.js";import{I as c}from"./InputError-ByfgtF5w.js";import{A as K}from"./AlertMessage-CubBamYp.js";import{h as Q}from"./moment-C5S46NFB.js";import{C as p}from"./Constants-Cwa85801.js";import"./SR-BoSPAYsv.js";import"./transition-YMyy0hwJ.js";function oe({auth:q,measurements:C,suppliesUrl:X,supply:x}){var y,_,N;const j=u.useRef(null),t=w().props.errors,a=w().props,{data:i,setData:l,post:T,patch:A,reset:I,processing:M}=V({measurement_unit:null,name:"",use_type:null,total_price:"",quantity:"",available_quantity:"",notes:"",manual_created_at:Q().format(p.DATEFORMAT)}),[k,f]=u.useState(""),[R,g]=u.useState("Seleccionar"),[E,h]=u.useState("Seleccionar");u.useEffect(()=>{var s;(s=a==null?void 0:a.supply)!=null&&s.id&&F(a.supply)},[]);const F=s=>{l({measurement_unit_id:s.measurement_unit_id,name:s.name,use_type:s.use_type,notes:s.notes}),h(p.SUPPLIES_USES_TYPES[s.use_type]),g(s.measurement_unit.name)},L=s=>{var n;s.preventDefault(),(n=a==null?void 0:a.supply)!=null&&n.id?A(a.formActionUrl,{onSuccess:()=>v()}):T(a.formActionUrl,{onSuccess:()=>v()})},v=()=>{var n,r;let s=(n=a==null?void 0:a.supply)!=null&&n.id?"modificado":"agregado";(r=a==null?void 0:a.supply)!=null&&r.id||I(),f(`El suministro fue ${s} satisfactoriamente`),j.current.click()},Y=()=>{window.confirm("¿Estás seguro de que deseas eliminar este suministro?")&&$.delete(route("supplies.delete",{supplyId:a.supply.id}))},z=()=>C.map(s=>e.jsx(D,{onClick:()=>B(s),children:s.name},s.id)),B=s=>{g(s.name),l({...i,measurement_unit_id:s.id})},G=()=>{let s=p.SUPPLIES_USES_TYPES,n=[];for(let r in s)n.push(e.jsx(D,{onClick:()=>O(r,s[r]),children:s[r]},r));return n},O=(s,n)=>{h(n),l({...i,use_type:s})};return e.jsxs(H,{user:q.user,children:[e.jsx(W,{title:"Agregar suministro"}),e.jsx("div",{className:"py-4 lg:py-12",children:e.jsx("form",{onSubmit:L,children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-4 lg:px-4",children:[e.jsx(K,{title:k,onClose:()=>f("")}),e.jsxs("div",{className:"",children:[e.jsx("div",{className:"flex justify-between items-start flex-wrap gap-4 mb-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-1",children:[e.jsx(S,{href:"/supplies",className:"hover:text-gray-700",children:"Infraestructura"}),e.jsx("span",{className:"mx-2",children:">"}),e.jsx("span",{className:"text-gray-700",children:(y=a==null?void 0:a.supply)!=null&&y.id?"Editar Suministro":"Agregar Suministro"})]}),e.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:[(_=a==null?void 0:a.supply)!=null&&_.id?"Editar":"Nuevo"," Suministro"]})]})}),e.jsx(S,{className:"w-full sm:w-auto",href:route("supplies"),children:e.jsx(U,{children:"Regresar"})})]}),e.jsx("br",{}),e.jsx("div",{className:"bg-white shadow-sm rounded-lg p-5",children:e.jsxs("div",{className:"grid md:grid-cols-3 sm:grid-cols-1 gap-4 xs:grid-cols-1 mb-4",children:[e.jsxs("div",{className:"w-full md:col-span-1 sm:col-span-4",children:[e.jsx(m,{value:"Nombre del producto"}),e.jsx(o,{type:"text",className:"w-full",name:"name",value:i.name,required:!0,onChange:s=>l(s.target.name,s.target.value)}),(t==null?void 0:t.name)&&e.jsx(c,{message:t.name})]}),!(x!=null&&x.id)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full md:col-span-1 sm:col-span-4",children:[e.jsx(m,{value:"Cantidad"}),e.jsx(o,{type:"number",className:"w-full",name:"quantity",value:i.quantity,required:!0,onChange:s=>l(s.target.name,s.target.value)}),(t==null?void 0:t.quantity)&&e.jsx(c,{message:t.quantity})]}),e.jsxs("div",{className:"w-full md:col-span-1 sm:col-span-4",children:[e.jsx(m,{value:"Precio"}),e.jsx(o,{type:"number",className:"w-full",name:"total_price",value:i.total_price,required:!0,onChange:s=>l(s.target.name,s.target.value)}),(t==null?void 0:t.total_price)&&e.jsx(c,{message:t.total_price})]}),e.jsxs("div",{className:"w-full md:col-span-1 sm:col-span-4",children:[e.jsx(m,{value:"Fecha de compra"}),e.jsx(o,{type:"date",className:"w-full",name:"manual_created_at",value:i.manual_created_at,required:!0,onChange:s=>l(s.target.name,s.target.value)}),(t==null?void 0:t.manual_created_at)&&e.jsx(c,{message:t.manual_created_at})]})]}),e.jsxs("div",{className:"md:col-span-1 sm:col-span-4",children:[e.jsx(m,{value:"Unidad de medida"}),e.jsxs(d,{children:[e.jsx(d.Trigger,{children:e.jsx(b,{className:"items-center cursor-pointer",children:R})}),e.jsx(d.Content,{align:"left",className:"px-2",width:100,children:z()})]}),(t==null?void 0:t.measurement_unit_id)&&e.jsx(c,{message:t.measurement_unit_id})]}),e.jsxs("div",{className:"md:col-span-1 sm:col-span-4",children:[e.jsx(m,{value:"Uso"}),e.jsxs(d,{children:[e.jsx(d.Trigger,{children:e.jsx(b,{className:"items-center cursor-pointer",children:E})}),e.jsx(d.Content,{align:"left",className:"px-2",width:100,children:G()})]}),(t==null?void 0:t.use_type)&&e.jsx(c,{message:t.use_type})]}),e.jsxs("div",{className:"w-full md:col-span-3 sm:col-span-4",children:[e.jsx(m,{value:"Notas"}),e.jsx(J,{className:"w-full",name:"notes",value:i.notes,onChange:s=>l(s.target.name,s.target.value)}),(t==null?void 0:t.notes)&&e.jsx(c,{message:t.notes})]})]})}),((N=a==null?void 0:a.supply)==null?void 0:N.id)&&e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-5 mt-6 border border-gray-300",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2 text-gray-800",children:"Eliminación"}),e.jsxs("p",{className:"mb-4 text-gray-600",children:["Se eliminará permanentemente el suministro “",e.jsx("strong",{children:a.supply.name}),"”. Verifica que sea la acción que quieres realizar."]}),e.jsx("button",{type:"button",onClick:Y,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition duration-200",children:"Eliminar suministro"})]}),e.jsxs("div",{className:"flex gap-4 justify-end mt-4",children:[e.jsx(U,{className:"bg-orange-600 w-full sm:w-auto text-white",disabled:M,children:"Guardar"}),e.jsx("button",{type:"reset",className:"hidden",ref:j,children:"reset"})]})]})})})]})}export{oe as default};
